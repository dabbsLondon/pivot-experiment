<svg xmlns="http://www.w3.org/2000/svg" width="900" height="500" viewBox="0 0 900 500" role="img" aria-label="Architecture diagram">
  <defs>
    <style>
      .box { stroke-width: 2; rx: 8; }
      .box-web { fill: #dbeafe; stroke: #2563eb; }
      .box-api { fill: #fef3c7; stroke: #d97706; }
      .box-db { fill: #dcfce7; stroke: #16a34a; }
      .box-cache { fill: #fef08a; stroke: #ca8a04; }
      .box-tool { fill: #f3e8ff; stroke: #9333ea; }
      .box-data { fill: #e0e7ff; stroke: #4f46e5; }
      .title { font: bold 14px system-ui, -apple-system, sans-serif; fill: #1e293b; }
      .subtitle { font: 11px system-ui, -apple-system, sans-serif; fill: #64748b; }
      .label { font: 12px system-ui, -apple-system, sans-serif; fill: #334155; }
      .section-title { font: bold 12px system-ui, -apple-system, sans-serif; fill: #475569; }
      .arrow { stroke: #64748b; stroke-width: 2; fill: none; }
      .arrow-label { font: 10px system-ui, -apple-system, sans-serif; fill: #64748b; }
      .section { fill: none; stroke: #e2e8f0; stroke-width: 1; stroke-dasharray: 4; rx: 12; }
    </style>
    <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#64748b" />
    </marker>
  </defs>

  <!-- Background sections -->
  <rect class="section" x="20" y="20" width="280" height="180" />
  <text class="section-title" x="35" y="42">Frontend</text>

  <rect class="section" x="320" y="20" width="260" height="180" />
  <text class="section-title" x="335" y="42">Backend</text>

  <rect class="section" x="600" y="20" width="280" height="180" />
  <text class="section-title" x="615" y="42">Storage</text>

  <rect class="section" x="20" y="220" width="860" height="260" />
  <text class="section-title" x="35" y="242">Data Layer</text>

  <!-- Web App -->
  <rect class="box box-web" x="50" y="60" width="220" height="70" />
  <text class="title" x="160" y="90" text-anchor="middle">Web Application</text>
  <text class="subtitle" x="160" y="108" text-anchor="middle">apps/web (React)</text>

  <!-- API Server -->
  <rect class="box box-api" x="350" y="60" width="200" height="70" />
  <text class="title" x="450" y="90" text-anchor="middle">API Server</text>
  <text class="subtitle" x="450" y="108" text-anchor="middle">services/api (Rust)</text>

  <!-- ClickHouse -->
  <rect class="box box-db" x="630" y="50" width="220" height="90" />
  <text class="title" x="740" y="80" text-anchor="middle">ClickHouse</text>
  <text class="subtitle" x="740" y="98" text-anchor="middle">OLAP Database</text>
  <text class="label" x="740" y="118" text-anchor="middle">trades, instruments, constituents</text>

  <!-- Redis -->
  <rect class="box box-cache" x="350" y="145" width="200" height="45" />
  <text class="title" x="450" y="173" text-anchor="middle">Redis Cache</text>

  <!-- Data Generator -->
  <rect class="box box-tool" x="50" y="270" width="200" height="70" />
  <text class="title" x="150" y="298" text-anchor="middle">Data Generator</text>
  <text class="subtitle" x="150" y="316" text-anchor="middle">tools/data-gen (Rust)</text>

  <!-- Data Files -->
  <rect class="box box-data" x="300" y="260" width="280" height="90" />
  <text class="title" x="440" y="288" text-anchor="middle">Generated Data Files</text>
  <text class="label" x="440" y="308" text-anchor="middle">trades.csv | instruments.csv</text>
  <text class="label" x="440" y="326" text-anchor="middle">constituents.csv</text>

  <!-- Data Model Box -->
  <rect class="box box-db" x="630" y="260" width="220" height="200" />
  <text class="title" x="740" y="288" text-anchor="middle">Data Model</text>

  <text class="label" x="650" y="315">instruments</text>
  <text class="subtitle" x="650" y="330">29 symbols (stocks, ETFs, ETCs)</text>

  <text class="label" x="650" y="355">constituents</text>
  <text class="subtitle" x="650" y="370">ETF/ETC → underlying mappings</text>

  <text class="label" x="650" y="395">trades_1d</text>
  <text class="subtitle" x="650" y="410">54 columns, partitioned by date</text>

  <text class="label" x="650" y="435">trades_1d_rollup</text>
  <text class="subtitle" x="650" y="450">Pre-aggregated summaries</text>

  <!-- Constituent Explosion -->
  <rect class="box box-tool" x="50" y="370" width="200" height="90" />
  <text class="title" x="150" y="398" text-anchor="middle">Constituent Explosion</text>
  <text class="label" x="150" y="418" text-anchor="middle">SPY trade →</text>
  <text class="subtitle" x="150" y="436" text-anchor="middle">AAPL + MSFT + GOOGL + ...</text>

  <!-- Arrows -->
  <!-- Web to API -->
  <line class="arrow" x1="270" y1="95" x2="350" y2="95" marker-end="url(#arrowhead)" />
  <text class="arrow-label" x="310" y="88" text-anchor="middle">HTTP</text>

  <!-- API to ClickHouse -->
  <line class="arrow" x1="550" y1="85" x2="630" y2="85" marker-end="url(#arrowhead)" />
  <text class="arrow-label" x="590" y="78" text-anchor="middle">Query</text>

  <!-- API to Redis -->
  <line class="arrow" x1="450" y1="130" x2="450" y2="145" marker-end="url(#arrowhead)" />

  <!-- Data Gen to Files -->
  <line class="arrow" x1="250" y1="305" x2="300" y2="305" marker-end="url(#arrowhead)" />
  <text class="arrow-label" x="275" y="298" text-anchor="middle">CSV</text>

  <!-- Files to ClickHouse -->
  <line class="arrow" x1="580" y1="305" x2="630" y2="305" marker-end="url(#arrowhead)" />
  <text class="arrow-label" x="605" y="298" text-anchor="middle">Load</text>

  <!-- Constituent to Files -->
  <line class="arrow" x1="250" y1="415" x2="300" y2="340" marker-end="url(#arrowhead)" />
  <text class="arrow-label" x="260" y="365" text-anchor="middle">expand</text>
</svg>
